import{a as z,L as $,r as x,t as B,v as N,z as e,A as t,V as E,M as l,N as S,O as n,B as h,y as k,P as F,Q as I,R as j,S as O,x as f,T as q,U as G,W as M}from"./CxCi84D5.js";import{u as T}from"./KKXyQTFi.js";import{V as U,a as Q}from"./CNL2HLNc.js";import{V as W,a as H}from"./B_-zNqXP.js";import{V as P,a as L}from"./Dd-OUGDu.js";import{V as J}from"./BJwYn0dg.js";import{V as K}from"./BSRGpNRQ.js";import"./CXzoZ99M.js";import"./DllL5wLp.js";const X={class:"text-center"},Y={__name:"BranchDialog",emits:["exitDialog"],setup(R,{emit:A}){const{$api:_}=z(),c=T(),o=$(),p=A,a=x({}),g=x(!1),v=x(!0),s=x(!1),b=()=>a.value.readonly===!0;function d(){v.value?i():y()}function C(){c.branch.payload?(a.value=c.branch.payload,v.value=!1):(a.value={},v.value=!0)}function u(){p("exitDialog"),s.value=!1,c.setBranch({dialog:!1})}function r(){s.value?D():s.value=!0}const i=async()=>{try{const m=await _.post("/branches/",a.value);o.setAlert({show:!0,color:"success",content:"New Branch Created!"}),u()}catch{o.setAlert({show:!0,color:"error",content:"Failed to create Branch."})}},y=async()=>{try{const m=await _.put(`/branches/${a.value.id}`,a.value);o.setAlert({show:!0,color:"success",content:"Branch Updated!"}),u()}catch{o.setAlert({show:!0,color:"error",content:"Failed to Update Branch."})}},D=async()=>{try{const m=await _.delete(`/branches/${a.value.id}`);o.setAlert({show:!0,color:"success",content:"Branch Deleted!"}),s.value=!1,u()}catch{o.setAlert({show:!0,color:"error",content:"Failed to Delete Branch."}),s.value=!1}};return(m,V)=>(B(),N("div",X,[e(O,{modelValue:l(c).branch.dialog,"onUpdate:modelValue":V[2]||(V[2]=w=>l(c).branch.dialog=w),width:"auto",onAfterEnter:C,onAfterLeave:u},{default:t(()=>[e(E,{class:"px-5 pb-4",width:"700","max-width":"700","prepend-icon":"mdi-store",text:"",title:"Branch Information",flat:""},{actions:t(()=>[!l(v)&&!b()?(B(),S(n,{key:0,class:"text-none",color:"red",size:"large",onClick:r,variant:"tonal"},{default:t(()=>[h(k(l(s)?"Click again to confirm":"Delete Branch"),1)]),_:1})):F("",!0),e(U),e(n,{class:"text-none",color:"red",size:"large",onClick:u,variant:"tonal"},{default:t(()=>[h(" Close ")]),_:1}),b()?F("",!0):(B(),S(n,{key:1,class:"text-none",color:"blue",size:"large",onClick:d,variant:"tonal"},{default:t(()=>[h(" Submit ")]),_:1}))]),default:t(()=>[e(W,{modelValue:l(g),"onUpdate:modelValue":V[1]||(V[1]=w=>I(g)?g.value=w:null),readonly:b()},{default:t(()=>[e(Q,null,{default:t(()=>[e(P,null,{default:t(()=>[e(L,{cols:"12",md:"12"},{default:t(()=>[e(j,{modelValue:l(a).name,"onUpdate:modelValue":V[0]||(V[0]=w=>l(a).name=w),counter:10,label:"Branch Name","hide-details":"",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","readonly"])]),_:1})]),_:1},8,["modelValue"])]))}},Z={class:"text-h4 font-weight-bold d-flex justify-space-between mb-4 align-center"},ee=f("div",{class:"text-truncate"},"Branches",-1),te={class:"d-flex align-center"},ae=f("span",{class:"text-decoration-underline text-none"},"See all",-1),oe={class:"d-inline-flex"},le={class:"text-h6"};const _e={__name:"index",setup(R){const{$api:A}=z(),_=T(),c=$(),o=x(8),p=x([]),a=()=>{o.value=o.value===8?p.value.length:8},g=async()=>{try{const d=await A.get("/branches/");p.value=d.data}catch{c.setAlert({show:!0,color:"error",content:"Failed to fetch Branches."})}};g();function v(d){_.setBranch({dialog:!0,payload:d})}function s(){_.setBranch({dialog:!0})}function b(){g()}return(d,C)=>{const u=Y;return B(),N("div",null,[e(J,{class:"px-5 mt-10",items:l(p),"items-per-page":l(o)},{header:t(({page:r,pageCount:i,prevPage:y,nextPage:D})=>[f("h1",Z,[ee,e(n,{class:"text-none ml-10",size:"large",onClick:C[0]||(C[0]=m=>s()),variant:"tonal"},{default:t(()=>[h(" Add Branch ")]),_:1}),e(U),f("div",te,[e(n,{class:"me-8",variant:"text",onClick:a},{default:t(()=>[ae]),_:1}),f("div",oe,[e(n,{disabled:r===1,class:"me-2",icon:"mdi-arrow-left",size:"small",variant:"tonal",onClick:y},null,8,["disabled","onClick"]),e(n,{disabled:r===i,icon:"mdi-arrow-right",size:"small",variant:"tonal",onClick:D},null,8,["disabled","onClick"])])])])]),default:t(({items:r})=>[e(P,null,{default:t(()=>[(B(!0),N(q,null,G(r,(i,y)=>(B(),S(L,{key:y,cols:"12",sm:"6",xl:"3"},{default:t(()=>[e(H,{border:""},{default:t(()=>[e(M,{title:"Name",density:"comfortable",lines:"two"},{title:t(()=>[f("strong",le,[h(k(i.raw.name)+" ",1),e(n,{flat:"",color:"grey-lighten-3",class:"text-none ml-3 mb-1",onClick:D=>v(i.raw),density:"comfortable",size:"small",icon:"mdi-pencil"},null,8,["onClick"]),e(n,{flat:"",rounded:"",readonly:"",color:"grey-lighten-3",class:"text-none ml-3 mb-1",size:"small","prepend-icon":"mdi-download"},{default:t(()=>[h(" Generate Report ")]),_:1})])]),_:2},1024),F("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),footer:t(({page:r,pageCount:i})=>[e(K,{class:"justify-space-between text-body-2 mt-4",color:"surface-variant"},{default:t(()=>[h(" Total branches: "+k(l(p).length)+" ",1),f("div",null,"Page "+k(r)+" of "+k(i),1)]),_:2},1024)]),_:1},8,["items","items-per-page"]),e(u,{onExitDialog:b})])}}};export{_e as default};
