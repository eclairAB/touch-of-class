import{_ as re}from"./j1PlAKlh.js";import{t as C,N as k,A as a,z as t,O as b,B as h,X as j,af as G,ah as N,ak as J,al as K,aj as Q,Y as F,aV as ce,aI as W,$ as S,aW as de,aX as ue,a2 as O,aL as ee,aY as me,aZ as fe,am as te,a_ as _e,au as ve,r as P,H as ge,aB as B,a$ as ye,ai as he,an as Ce,as as be,b0 as pe,ar as xe,a1 as ke,j as X,a as ae,L as Ve,b1 as De,v as E,T as L,U,M as v,x as i,y as u,V as I,aU as z,P as R,S as ne,aa as Se,a8 as $e,_ as we,a6 as le,a7 as ie,ab as Te,b2 as Pe,ac as Ie,W as ze}from"./CxCi84D5.js";import{a as A}from"./B_-zNqXP.js";import{u as M}from"./KKXyQTFi.js";import{a as oe,V as Ae}from"./Dd-OUGDu.js";import{V as Be,a as Ee,c as Le,b as Ue}from"./UVcE-Koj.js";import{_ as Re}from"./CZrufNRg.js";import{V as Y}from"./CNL2HLNc.js";import{V as je}from"./BJwYn0dg.js";import{V as Ne}from"./CXzoZ99M.js";import{V as Fe}from"./BSRGpNRQ.js";const Oe={__name:"Actions",emits:["childEmit"],setup(e,{emit:m}){const c=m;function s(){c("childEmit",1)}return(d,f)=>(C(),k(A,{class:"pa-5 justify-center d-flex flex-wrap ga-2"},{default:a(()=>[t(b,{class:"text-none",color:"#c6811b",size:"large",onClick:f[0]||(f[0]=_=>s()),variant:"tonal"},{default:a(()=>[h(" Make Payment ")]),_:1})]),_:1}))}},Me=j({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:G,iconColor:String,lineColor:String,...N(),...J(),...K(),...Q()},"VTimelineDivider"),We=F()({name:"VTimelineDivider",props:Me(),setup(e,m){let{slots:c}=m;const{sizeClasses:s,sizeStyles:d}=ce(e,"v-timeline-divider__dot"),{backgroundColorStyles:f,backgroundColorClasses:_}=W(S(e,"dotColor")),{roundedClasses:y}=de(e,"v-timeline-divider__dot"),{elevationClasses:p}=ue(e),{backgroundColorClasses:w,backgroundColorStyles:T}=W(S(e,"lineColor"));return O(()=>t("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":e.fillDot},e.class],style:e.style},[t("div",{class:["v-timeline-divider__before",w.value],style:T.value},null),!e.hideDot&&t("div",{key:"dot",class:["v-timeline-divider__dot",p.value,y.value,s.value],style:d.value},[t("div",{class:["v-timeline-divider__inner-dot",_.value,y.value],style:f.value},[c.default?t(me,{key:"icon-defaults",disabled:!e.icon,defaults:{VIcon:{color:e.iconColor,icon:e.icon,size:e.size}}},c.default):t(ee,{key:"icon",color:e.iconColor,icon:e.icon,size:e.size},null)])]),t("div",{class:["v-timeline-divider__after",w.value],style:T.value},null)])),{}}}),se=j({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:G,iconColor:String,lineInset:[Number,String],...N(),...fe(),...Q(),...J(),...K(),...te()},"VTimelineItem"),q=F()({name:"VTimelineItem",props:se(),setup(e,m){let{slots:c}=m;const{dimensionStyles:s}=_e(e),d=ve(0),f=P();return ge(f,_=>{var y;_&&(d.value=((y=_.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:y.getBoundingClientRect().width)??0)},{flush:"post"}),O(()=>{var _,y;return t("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":e.fillDot},e.class],style:[{"--v-timeline-dot-size":B(d.value),"--v-timeline-line-inset":e.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${B(e.lineInset)})`:B(0)},e.style]},[t("div",{class:"v-timeline-item__body",style:s.value},[(_=c.default)==null?void 0:_.call(c)]),t(We,{ref:f,hideDot:e.hideDot,icon:e.icon,iconColor:e.iconColor,size:e.size,elevation:e.elevation,dotColor:e.dotColor,fillDot:e.fillDot,rounded:e.rounded},{default:c.icon}),e.density!=="compact"&&t("div",{class:"v-timeline-item__opposite"},[!e.hideOpposite&&((y=c.opposite)==null?void 0:y.call(c))])])}),{}}}),Xe=j({align:{type:String,default:"center",validator:e=>["center","start"].includes(e)},direction:{type:String,default:"vertical",validator:e=>["vertical","horizontal"].includes(e)},justify:{type:String,default:"auto",validator:e=>["auto","center"].includes(e)},side:{type:String,validator:e=>e==null||["start","end"].includes(e)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:e=>["start","end","both"].includes(e)},...ye(se({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...N(),...he(),...te(),...Ce()},"VTimeline"),H=F()({name:"VTimeline",props:Xe(),setup(e,m){let{slots:c}=m;const{themeClasses:s}=be(e),{densityClasses:d}=pe(e),{rtlClasses:f}=xe();ke({VTimelineDivider:{lineColor:S(e,"lineColor")},VTimelineItem:{density:S(e,"density"),dotColor:S(e,"dotColor"),fillDot:S(e,"fillDot"),hideOpposite:S(e,"hideOpposite"),iconColor:S(e,"iconColor"),lineColor:S(e,"lineColor"),lineInset:S(e,"lineInset"),size:S(e,"size")}});const _=X(()=>{const p=e.side?e.side:e.density!=="default"?"end":null;return p&&`v-timeline--side-${p}`}),y=X(()=>{const p=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(e.truncateLine){case"both":return p;case"start":return p[0];case"end":return p[1];default:return null}});return O(()=>t(e.tag,{class:["v-timeline",`v-timeline--${e.direction}`,`v-timeline--align-${e.align}`,`v-timeline--justify-${e.justify}`,y.value,{"v-timeline--inset-line":!!e.lineInset},s.value,d.value,_.value,f.value,e.class],style:[{"--v-timeline-line-thickness":B(e.lineThickness)},e.style]},c)),{}}}),Ye={class:"me-4"},qe={class:"text-grey text-caption"},He={class:"text-caption"},Ze={class:"text-grey text-caption"},Ge=i("i",{class:"text-grey text-caption"}," - service",-1),Je=i("div",{class:"text-caption"},"Unavailed",-1),Ke={class:"text-grey text-caption"},Qe=i("div",{class:"text-caption"},"Unavailed",-1),Z={__name:"Appointments",setup(e){const{$api:m}=ae(),c=Ve(),s=M(),d=De(),f=P([]),_=P({}),y=P({});(async()=>{try{const r=s.clientInfo.payload.id;(await m.get(`/appointments/${r}`)).data.forEach(n=>{n.package_redeems.length>0&&T(n.package_redeems),n.combo_redeems.length>0&&V(n.combo_redeems),n.service_redeems.length>0&&D(n.service_redeems)})}catch{c.setAlert({show:!0,color:"error",content:"Failed to fetch appointments."})}})();function w(r){const l=new Date(r),n={year:"numeric",month:"short",day:"numeric"};return l.toLocaleDateString("en-US",n).replace(",","")}function T(r){const l=r.reduce((n,o)=>{const x=n.find($=>$.name===o.package.name);return x?o.branch_id&&x.claimed++:n.push({variation:"package",name:o.package.name,sessions:o.package.sessions,claimed:o.branch_id?1:0,created_at:o.created_at}),n},[]);f.value.unshift(...l)}function V(r){const l=r.reduce((n,o)=>{const x=n.find($=>$.name===o.combo.name);return x?o.branch_id&&x.claimed++:n.push({variation:"combo",name:o.combo.name,services:o.combo.combo_services,claimed:o.branch_id?1:0,created_at:o.created_at}),n},[]);f.value.unshift(...l)}function D(r){r.forEach(l=>{f.value.unshift({variation:"service",name:l.service.name,claimed:l.branch_id?1:0,created_at:l.created_at})})}function g(r){_.value.status=!0,y.value.form=r}return(r,l)=>(C(),k(A,{class:"appointment-tab pa-5 d-flex flex-wrap ga-2"},{default:a(()=>[t(H,{align:"start",side:"end","truncate-line":"start"},{default:a(()=>[(C(!0),E(L,null,U(v(f),(n,o)=>(C(),k(q,{key:o,"dot-color":"pink",size:"small"},{opposite:a(()=>[i("strong",Ye,u(w(n.created_at)),1)]),default:a(()=>[n.variation=="package"?(C(),k(I,{key:0,flat:"",border:"",class:"py-2 px-4"},{default:a(()=>[i("strong",null,u(n.name),1),i("i",qe," - "+u(n.variation),1),i("div",He," Availed sessions: "+u(n.claimed)+"/"+u(n.sessions),1),t(z,null,{default:a(()=>[t(b,{color:"blue",class:"text-none",onClick:x=>g(n)},{default:a(()=>[h("Avail")]),_:2},1032,["onClick"]),t(b,{color:"green",class:"text-none"},{default:a(()=>[h("Make Payment")]),_:1})]),_:2},1024)]),_:2},1024)):R("",!0),n.variation=="combo"?(C(),k(I,{key:1,flat:"",border:"",class:"py-2 px-4"},{default:a(()=>[i("strong",null,u(n.name),1),i("i",Ze," - "+u(n.variation),1),t(z,null,{default:a(()=>[t(b,{color:"blue",class:"text-none",onClick:x=>g(n)},{default:a(()=>[h("Avail")]),_:2},1032,["onClick"]),t(b,{color:"green",class:"text-none"},{default:a(()=>[h("Make Payment")]),_:1})]),_:2},1024),t(H,{align:"start","truncate-line":"end"},{default:a(()=>[(C(!0),E(L,null,U(n.services,(x,$)=>(C(),k(q,{key:$,"dot-color":"grey",size:"x-small"},{default:a(()=>[i("div",null,[h(u(x.service.name)+" ",1),Ge,Je])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):R("",!0),n.variation=="service"?(C(),k(I,{key:2,flat:"",border:"",class:"py-2 px-4"},{default:a(()=>[i("strong",null,u(n.name),1),i("i",Ke," - "+u(n.variation),1),Qe,t(z,null,{default:a(()=>[t(b,{color:"blue",class:"text-none",onClick:x=>g({item:n})},{default:a(()=>[h("Avail")]),_:2},1032,["onClick"]),t(b,{color:"green",class:"text-none"},{default:a(()=>[h("Make Payment")]),_:1})]),_:2},1024)]),_:2},1024)):R("",!0)]),_:2},1024))),128))]),_:1}),t(ne,{modelValue:v(_).status,"onUpdate:modelValue":l[3]||(l[3]=n=>v(_).status=n),width:"500",persistent:""},{default:a(()=>[t(I,{"prepend-icon":"mdi-content-cut",title:"Product avail"},{default:a(()=>[t(oe,{class:"px-5"},{default:a(()=>[t(Se,{class:"mb-4",color:"orange"},{default:a(()=>[t(ee,{icon:"mdi-alert-circle",start:""}),h(" Availing in "),i("strong",null,u(v(d).branch.select.name),1),h(" Branch ")]),_:1}),t($e,{modelValue:v(y).stylist_id,"onUpdate:modelValue":l[0]||(l[0]=n=>v(y).stylist_id=n),label:"Select Catering Stylist",items:[],density:"comfortable",variant:"outlined","item-value":"id",chips:""},null,8,["modelValue"])]),_:1}),t(z,null,{default:a(()=>[t(b,{color:"success",class:"text-none",text:"confirm avail",onClick:l[1]||(l[1]=n=>v(_).status=!1)}),t(b,{color:"error",class:"text-none",text:"cancel",onClick:l[2]||(l[2]=n=>v(_).status=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},et={};function tt(e,m){return C(),k(A,{class:"pa-5 justify-center d-flex flex-wrap ga-2"},{default:a(()=>[h(" loyalty cards ")]),_:1})}const at=we(et,[["render",tt]]),nt={__name:"Payment",emits:["childEmit"],setup(e,{emit:m}){const c=m;function s(){c("childEmit",2)}return(d,f)=>(C(),k(A,{class:"pa-5 justify-center d-flex flex-wrap ga-2"},{default:a(()=>[t(I,{class:"w-100",flat:""},{default:a(()=>[t(z,null,{default:a(()=>[t(b,{class:"text-none",onClick:s,variant:"tonal"},{default:a(()=>[h(" Close ")]),_:1})]),_:1})]),_:1}),h(" Payment ")]),_:1}))}},lt={__name:"index",setup(e){const m=M(),c={action:Oe,appointments:Z,cards:at,payment:nt},s=P({current:"tab-2",status:!1}),d=P([{text:"Appointments",value:"tab-2",component:"appointments"},{text:"Loyalty Cards",value:"tab-3",component:"cards"}]),f={text:"Payment",value:"tab-4",component:"payment"};function _(g){return c[g]}function y(){s.value.current="tab-2"}function p(){m.setClientInfo({dialog:!1})}const w=()=>{if(m.clientInfo.payload)return`${m.clientInfo.payload.first_name} ${m.clientInfo.payload.last_name}`};function T(g){switch(g){case 1:V();break;case 2:D();break}}function V(){d.value.some(r=>r.value===f.value)||(d.value.unshift(f),s.value.current="tab-4",s.value.status=!0)}function D(){d.value=d.value.filter(g=>g.value!==f.value),s.value.current="tab-2",s.value.status=!1,setTimeout(()=>{Z.value.fetchAppointmentsData()},500)}return(g,r)=>(C(),k(ne,{modelValue:v(m).clientInfo.dialog,"onUpdate:modelValue":r[2]||(r[2]=l=>v(m).clientInfo.dialog=l),width:"1000",onAfterEnter:y,onAfterLeave:p,class:Pe(`${v(s).current}-dialog`)},{default:a(()=>[t(I,{height:"600"},{default:a(()=>[t(le,{color:"orange-lighten-4"},{extension:a(()=>[t(Be,{modelValue:v(s).current,"onUpdate:modelValue":r[0]||(r[0]=l=>v(s).current=l),items:v(d),height:"60","slider-color":"#f78166","fixed-tabs":""},{tab:a(({item:l})=>[t(Ee,{text:l.text,value:l.value,disabled:v(s).status?l.value!="tab-4":!1,class:"text-none"},null,8,["text","value","disabled"])]),_:1},8,["modelValue","items"])]),default:a(()=>[t(ie,null,{default:a(()=>[i("b",null,u(w()),1)]),_:1}),t(z,null,{default:a(()=>[t(b,{onClick:p,class:"text-none"},{default:a(()=>[h("Close")]),_:1})]),_:1})]),_:1}),t(Le,{modelValue:v(s).current,"onUpdate:modelValue":r[1]||(r[1]=l=>v(s).current=l)},{default:a(()=>[(C(!0),E(L,null,U(v(d),(l,n)=>(C(),k(Ue,{key:n,value:l.value,class:"pt-2"},{default:a(()=>[(C(),k(Te(_(l.component)),{onChildEmit:T},null,32))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","class"]))}},it=i("b",null,"Clients",-1),ot={class:"text-h4 font-weight-bold d-flex justify-space-between mb-4 pt-5 align-center"},st={class:"d-flex align-center"},rt=i("span",{class:"text-decoration-underline text-none"},"See all",-1),ct={class:"d-inline-flex"},dt={class:"text-h6"},ut={align:"right"},mt=i("th",null,"Payment Balances:",-1),ft={align:"right"},_t=i("th",null,"Pending Sessions:",-1),vt={align:"right"},gt=i("th",null,"Pending Services:",-1),yt={align:"right"},ht=i("th",null,"Loyalty Card 1:",-1),Ct={align:"right"},bt=i("th",null,"Loyalty Card 2:",-1),zt={__name:"List",setup(e){const{$api:m}=ae(),c=M(),s=P(4),d=P([]),f=()=>{s.value=s.value===4?d.value.length:4},_=async()=>{try{const V=await m.get("/clients/");let D=V.data;for(let g in D){let r=0,l=0,n=0;if(D[g].appointments)for(let o of D[g].appointments)o.combo&&r++,o.package&&l++;D[g].img="https://bit.ly/4dnXrBi",D[g].combo=r,D[g].session=l}d.value=V.data}catch(V){console.error("Failed to fetch user data:",V)}};_();function y(V){c.setClient({dialog:!0,payload:V})}function p(){c.setClient({dialog:!0})}function w(V){c.setClientInfo({dialog:!0,payload:V})}function T(){_()}return(V,D)=>{const g=re,r=lt,l=Re;return C(),k(I,{flat:"",border:"",class:"w-75"},{default:a(()=>[t(le,{color:"orange-lighten-4"},{default:a(()=>[t(ie,null,{default:a(()=>[it,t(b,{class:"text-none ml-10",size:"large",onClick:D[0]||(D[0]=n=>p()),variant:"tonal"},{default:a(()=>[h(" Add Client ")]),_:1})]),_:1}),t(Y),t(b,{icon:"mdi-magnify",variant:"text"})]),_:1}),t(je,{class:"px-5",items:v(d),"items-per-page":v(s)},{header:a(({page:n,pageCount:o,prevPage:x,nextPage:$})=>[i("h1",ot,[t(Y),i("div",st,[t(b,{class:"me-8",variant:"text",onClick:f},{default:a(()=>[rt]),_:1}),i("div",ct,[t(b,{disabled:n===1,class:"me-2",icon:"mdi-arrow-left",size:"small",variant:"tonal",onClick:x},null,8,["disabled","onClick"]),t(b,{disabled:n===o,icon:"mdi-arrow-right",size:"small",variant:"tonal",onClick:$},null,8,["disabled","onClick"])])])])]),default:a(({items:n})=>[t(Ae,null,{default:a(()=>[(C(!0),E(L,null,U(n,(o,x)=>(C(),k(oe,{key:x,cols:"12",sm:"6",xl:"3"},{default:a(()=>[t(A,{border:""},{default:a(()=>[t(Ie,{gradient:"to top right, rgba(255, 255, 255, .1), rgba(255, 255, 255, .15)",src:o.raw.img,height:"150",cover:""},null,8,["src"]),t(ze,{title:"Name",density:"comfortable",lines:"two"},{title:a(()=>[i("strong",dt,[h(u(o.raw.first_name)+" "+u(o.raw.last_name)+" ",1),t(b,{flat:"",color:"blue-lighten-5",class:"text-none ml-1 mb-1",onClick:$=>y(o.raw),density:"comfortable",size:"small",icon:"mdi-pencil"},null,8,["onClick"])])]),_:2},1024),t(Ne,{class:"text-caption",density:"compact"},{default:a(()=>[i("tbody",null,[i("tr",ut,[mt,i("td",null,"₱ "+u(o.raw.balances||0),1)]),i("tr",ft,[_t,i("td",null,u(o.raw.sessions||0),1)]),i("tr",vt,[gt,i("td",null,u(o.raw.combo||0),1)]),i("tr",yt,[ht,i("td",null,u(o.raw.loyalty_card_1||0)+" redeemed",1)]),i("tr",Ct,[bt,i("td",null,u(o.raw.loyalty_card_2||0)+" redeemed",1)])])]),_:2},1024),t(b,{flat:"",color:"grey-lighten-3",class:"text-none",block:"",onClick:$=>w(o.raw)},{default:a(()=>[h(" More info ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),footer:a(({page:n,pageCount:o})=>[t(Fe,{class:"justify-space-between text-body-2 mt-4",color:"surface-variant"},{default:a(()=>[h(" Total clients: "+u(v(d).length)+" ",1),i("div",null,"Page "+u(n)+" of "+u(o),1)]),_:2},1024)]),_:1},8,["items","items-per-page"]),t(g),t(r),t(l,{onExitDialog:T})]),_:1})}}};export{zt as _};
