import{_ as q}from"./j1PlAKlh.js";import{a as U,L as j,r as c,t as S,v as z,z as t,A as a,V as I,M as e,N as $,O as w,B as C,y as B,P as D,R as V,a8 as O,S as G,a6 as H,a7 as M,x as A,_ as W}from"./CxCi84D5.js";import{u as E}from"./KKXyQTFi.js";import{V as R,a as J}from"./CNL2HLNc.js";import"./DugkJYux.js";import{V as K}from"./B_-zNqXP.js";import{V as Q,a as g}from"./Dd-OUGDu.js";import{e as X}from"./BXVHIUk0.js";import"./BJwYn0dg.js";import"./CXzoZ99M.js";import"./BSRGpNRQ.js";import"./DllL5wLp.js";const Y={class:"text-center"},Z={__name:"StaffDialog",emits:["exitDialog"],setup(L,{emit:k}){const{$api:u}=U(),f=E(),p=j(),v=k,x=c([]),m=c(!1),o=c({}),s=c({}),h=c(!0),y=c(!1),P=async()=>{try{const n=await u.get("/staffs/roles/");x.value=n.data}catch(n){console.error("Failed to fetch roles data:",n)}};function T(){h.value?F():i()}function _(){P(),f.staff.payload?(o.value=f.staff.payload,h.value=!1):(o.value={},h.value=!0)}function d(){v("exitDialog"),y.value=!1,f.setStaff({dialog:!1}),s.value={}}function N(){y.value?b():y.value=!0}const F=async()=>{try{const n=await u.post("/users/",o.value);p.setAlert({show:!0,color:"success",content:"New Staff Created!"}),d()}catch(n){n.response.data&&(console.error(n.response.data),s.value=n.response.data.errors),p.setAlert({show:!0,color:"error",content:"Failed to create Staff."})}},i=async()=>{try{const n=await u.put(`/users/${o.value.id}`,o.value);p.setAlert({show:!0,color:"success",content:"Staff Updated!"}),d()}catch{p.setAlert({show:!0,color:"error",content:"Failed to Update Staff."})}},b=async()=>{try{const n=await u.delete(`/users/${o.value.id}`);p.setAlert({show:!0,color:"success",content:"Staff Deleted!"}),d()}catch{p.setAlert({show:!0,color:"error",content:"Failed to Delete Staff."})}};return(n,l)=>(S(),z("div",Y,[t(G,{modelValue:e(f).staff.dialog,"onUpdate:modelValue":l[9]||(l[9]=r=>e(f).staff.dialog=r),width:"auto",onAfterEnter:_,onAfterLeave:d},{default:a(()=>[t(I,{class:"px-5 pb-4",width:"700","max-width":"700","prepend-icon":"mdi-account",text:"",title:"Staff Information",flat:""},{actions:a(()=>[e(h)?D("",!0):(S(),$(w,{key:0,class:"text-none",color:"red",size:"large",onClick:N,variant:"tonal"},{default:a(()=>[C(B(e(y)?"Click again to confirm":"Delete Staff"),1)]),_:1})),t(R),t(w,{class:"text-none",color:"red",size:"large",onClick:d,variant:"tonal"},{default:a(()=>[C(" Close ")]),_:1}),t(w,{class:"text-none",color:"blue",size:"large",onClick:T,variant:"tonal"},{default:a(()=>[C(" Submit ")]),_:1})]),default:a(()=>[D("",!0),t(K,{ref:"staff_form"},{default:a(()=>[t(J,null,{default:a(()=>[t(Q,null,{default:a(()=>[t(g,{cols:"12",md:"6"},{default:a(()=>[t(V,{modelValue:e(o).first_name,"onUpdate:modelValue":l[0]||(l[0]=r=>e(o).first_name=r),"error-messages":e(s).first_name,"hide-details":!e(s).first_name,counter:10,label:"First name",variant:"outlined",required:""},null,8,["modelValue","error-messages","hide-details"])]),_:1}),t(g,{cols:"12",md:"6"},{default:a(()=>[t(V,{modelValue:e(o).last_name,"onUpdate:modelValue":l[1]||(l[1]=r=>e(o).last_name=r),"error-messages":e(s).last_name,"hide-details":!e(s).last_name,counter:10,label:"Last name",variant:"outlined",required:""},null,8,["modelValue","error-messages","hide-details"])]),_:1}),t(g,{cols:"12",md:"6"},{default:a(()=>[t(V,{modelValue:e(o).email,"onUpdate:modelValue":l[2]||(l[2]=r=>e(o).email=r),"error-messages":e(s).email,"hide-details":!e(s).email,label:"E-mail",variant:"outlined",required:""},null,8,["modelValue","error-messages","hide-details"])]),_:1}),t(g,{cols:"12",md:"6"},{default:a(()=>[t(V,{modelValue:e(o).contact_number,"onUpdate:modelValue":l[3]||(l[3]=r=>e(o).contact_number=r),"error-messages":e(s).contact_number,"hide-details":!e(s).contact_number,label:"Contact Number",variant:"outlined",required:""},null,8,["modelValue","error-messages","hide-details"])]),_:1}),t(g,{cols:"12",md:"12"},{default:a(()=>[t(O,{modelValue:e(o).role_id,"onUpdate:modelValue":l[4]||(l[4]=r=>e(o).role_id=r),"error-messages":e(s).role_id,"hide-details":!e(s).role_id,label:"Select Role",items:e(x),variant:"outlined","item-title":"name","item-value":"id",chips:""},null,8,["modelValue","error-messages","hide-details","items"])]),_:1}),t(g,{cols:"12",md:""},{default:a(()=>[t(V,{modelValue:e(o).password,"onUpdate:modelValue":l[5]||(l[5]=r=>e(o).password=r),"error-messages":e(s).password,"hide-details":!e(s).password,label:"Password",placeholder:"Enter Password",variant:"outlined","append-inner-icon":e(m)?"mdi-eye-off":"mdi-eye","prepend-inner-icon":"mdi-lock-outline",type:e(m)?"text":"password","onClick:appendInner":l[6]||(l[6]=r=>m.value=!e(m))},null,8,["modelValue","error-messages","hide-details","append-inner-icon","type"])]),_:1}),e(o).password?(S(),$(g,{key:0,cols:"12",md:""},{default:a(()=>[t(V,{modelValue:e(o).confirm_password,"onUpdate:modelValue":l[7]||(l[7]=r=>e(o).confirm_password=r),"error-messages":e(s).confirm_password,"hide-details":!e(s).confirm_password,label:"Confirm Password",placeholder:"Re-enter Password",variant:"outlined","append-inner-icon":e(m)?"mdi-eye-off":"mdi-eye","prepend-inner-icon":"mdi-lock-outline",type:e(m)?"text":"password","onClick:appendInner":l[8]||(l[8]=r=>m.value=!e(m))},null,8,["modelValue","error-messages","hide-details","append-inner-icon","type"])]),_:1})):D("",!0)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]))}},ee=A("b",null,"Staffs",-1);const te={__name:"List",setup(L){const{$api:k}=U(),u=E(),f=c({}),p=c(4),v=c([]),x=c(0),m=c([{title:"Name",key:"name"},{title:"email",key:"email"},{title:"contact",key:"contact_number"},{title:"role",key:"role"},{title:"actions",key:"actions"}]),o=()=>{p.value=p.value===4?v.value.length:4},s=async()=>{try{const _=f.value,d=await k.post("/staffs/search/",_);let N=d.data;v.value=d.data}catch(_){console.error("Failed to fetch user data:",_)}};s();function h(_){u.setStaff({dialog:!0,payload:_})}function y(){u.setStaff({dialog:!0})}function P(){s()}function T(){clearTimeout(x.value),x.value=setTimeout(()=>{s()},1e3)}return(_,d)=>{const N=q,F=Z;return S(),$(I,{flat:"",border:"",class:"w-75"},{default:a(()=>[t(H,{color:"orange-lighten-4"},{default:a(()=>[t(M,null,{default:a(()=>[ee,t(w,{class:"text-none ml-10",size:"large",onClick:d[0]||(d[0]=i=>y()),variant:"tonal"},{default:a(()=>[C(" Add Staff ")]),_:1})]),_:1}),t(R),t(V,{modelValue:e(f).search,"onUpdate:modelValue":d[1]||(d[1]=i=>e(f).search=i),onInput:T,"append-inner-icon":"mdi-magnify",density:"compact",label:"Search by name",variant:"solo","hide-details":"","single-line":"",flat:"",class:"mr-5"},null,8,["modelValue"])]),_:1}),t(X,{headers:e(m),items:e(v)},{"item.name":a(({item:i})=>[A("td",null,B(i.first_name)+" "+B(i.last_name),1)]),"item.role":a(({item:i})=>[A("td",null,B(i.role.name),1)]),"item.actions":a(({item:i})=>[A("td",null,[t(w,{flat:"",color:"grey-lighten-3",class:"text-none ml-3 mb-1",density:"comfortable",size:"small",icon:"mdi-pencil",onClick:b=>h(i)},null,8,["onClick"]),t(w,{flat:"",rounded:"",readonly:"",color:"grey-lighten-3",class:"text-none ml-3 mb-1",size:"small","prepend-icon":"mdi-download"},{default:a(()=>[C(" Generate Report ")]),_:1})])]),_:1},8,["headers","items"]),D("",!0),t(N),t(F,{onExitDialog:P})]),_:1})}}},ae={},oe={class:"w-100 h-100 d-flex justify-center align-center"};function le(L,k){const u=te;return S(),z("div",oe,[t(u)])}const ke=W(ae,[["render",le]]);export{ke as default};
